<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>草积分查询 + 空投估算</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      max-width: 900px;
      margin: auto;
      transition: background 0.3s, color 0.3s;
    }
    body.dark {
      background: #111;
      color: #eee;
    }
    h1, h2 { color: inherit; }
    textarea, input {
      padding: 8px;
      width: 100%;
      margin-top: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    button {
      padding: 8px 16px;
      margin-top: 10px;
      cursor: pointer;
      border-radius: 6px;
      border: none;
      background: #4caf50;
      color: white;
    }
    button:hover { background: #45a049; }
    #output {
      white-space: pre-wrap;
      background: #f9f9f9;
      padding: 12px;
      border-radius: 8px;
      margin-top: 20px;
      font-size: 14px;
      border: 1px solid #ddd;
    }
    table {
      width: 100%;
      margin-top: 20px;
      border-collapse: collapse;
    }
    th, td {
      padding: 10px;
      border: 1px solid #ccc;
      text-align: center;
    }
    th { background-color: #f0f0f0; }
    .error { color: red; font-weight: bold; }
    .found { color: green; font-weight: bold; }
    .formatted-value { font-size: 14px; color: gray; margin-top: 4px; }

    /* 移动端 */
    @media (max-width: 600px) {
      table, thead, tbody, th, td, tr {
        display: block;
        width: 100%;
      }
      th, td {
        text-align: left;
        padding: 6px;
      }
    }
  </style>
</head>
<body>
  <div style="text-align: right; font-size: 13px; margin-bottom: 10px">
    作者推特：<a href="https://x.com/0xXIAOc" target="_blank">@0xXIAOc</a>
    | <a href="#" onclick="toggleLang()">切换英文</a>
    | <a href="#" onclick="toggleDarkMode()">切换夜间模式</a>
  </div>

  <h1>🌱 草积分地址查询器</h1>

  <textarea id="addressInput" placeholder="请输入地址，多个地址换行输入"></textarea>
  <button onclick="searchAddress()">查询</button>

  <div id="output"></div>

  <h2>💰 空投金额估算 <a href="https://x.com/0xXIAOc" target="_blank" style="font-size:14px; margin-left:10px;">by @0xXIAOc</a></h2>

  <p>假设 FDV = <input id="fdv" value="600000000" style="width:120px"> 元 <span class="formatted-value" id="formattedFDV"></span> ，草总量 = 943.27 亿草</p>

  <label>你拥有的草数量：</label>
  <input id="myGrass" value="100000000" oninput="showFormattedGrass()" />
  <div class="formatted-value" id="formattedGrass"></div>

  <label>空投百分比（多个用逗号分隔）：</label>
  <input id="percentList" value="3,5,10,15,20" />

  <button onclick="updateAirdropTable()">计算</button>

  <table>
    <thead>
      <tr>
        <th>空投百分比</th>
        <th>空投金额（万元）</th>
        <th>每草价格（USD）</th>
        <th>你的草价值（USD）</th>
      </tr>
    </thead>
    <tbody id="airdropTableBody"></tbody>
  </table>

<script>
function formatNumber(num) {
  if (num >= 1e8) return (num / 1e8).toFixed(2) + " 亿";
  if (num >= 1e4) return (num / 1e4).toFixed(2) + " 万";
  return num;
}

function showFormattedGrass() {
  const val = parseFloat(document.getElementById("myGrass").value);
  document.getElementById("formattedGrass").innerText = isNaN(val) ? "" : "≈ " + formatNumber(val) + " 草";
}

function showFormattedFDV() {
  const val = parseFloat(document.getElementById("fdv").value);
  document.getElementById("formattedFDV").innerText = isNaN(val) ? "" : "≈ " + formatNumber(val) + "元";
}

document.getElementById("fdv").addEventListener("input", showFormattedFDV);

function updateAirdropTable() {
  const FDV = parseFloat(document.getElementById("fdv").value);
  const totalGrass = 94327000000;
  const myGrass = parseFloat(document.getElementById("myGrass").value) || 0;
  const percentRaw = document.getElementById("percentList").value;
  const percents = percentRaw.split(",").map(x => parseFloat(x.trim())).filter(x => !isNaN(x) && x > 0);

  if (!percents.length) {
    alert("空投百分比格式错误，请用逗号分隔，如 3,5,10");
    return;
  }

  let html = "";
  percents.forEach(pct => {
    const airdropAmount = FDV * (pct / 100);
    const grassPrice = airdropAmount / totalGrass;
    const myValue = myGrass * grassPrice;
    html += `<tr>
      <td>${pct}%</td>
      <td>${(airdropAmount / 10000).toFixed(2)}</td>
      <td>$${grassPrice.toFixed(6)}</td>
      <td>$${myValue.toFixed(2)}</td>
    </tr>`;
  });

  document.getElementById("airdropTableBody").innerHTML = html || `<tr><td colspan="4">暂无数据</td></tr>`;
}

function toggleDarkMode() {
  document.body.classList.toggle("dark");
}

function toggleLang() {
  alert("多语言支持开发中，敬请期待！\nMulti-language support coming soon!");
}

showFormattedGrass();
showFormattedFDV();
</script>
</body>
</html>
