<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>草积分空投估算</title>
  <style>
    body { font-family: sans-serif; padding: 20px; max-width: 800px; margin: auto; }
    h2 { color: #333; display: flex; align-items: center; gap: 10px; }
    textarea, input { padding: 8px; width: 100%; margin-top: 10px; }
    button {
      padding: 6px 12px; margin-top: 10px; cursor: pointer;
      background-color: #4CAF50; color: white; border: none; border-radius: 4px;
    }
    button:hover { background-color: #45a049; }
    #output {
      white-space: pre-wrap; background: #f6f6f6;
      padding: 12px; border-radius: 8px;
      margin-top: 20px; font-size: 14px;
    }
    table {
      width: 100%; margin-top: 20px; border-collapse: collapse;
    }
    th, td {
      padding: 8px; border: 1px solid #ccc; text-align: center;
    }
    th { background-color: #eee; }
    .error { color: red; font-weight: bold; }
    .small-note { font-size: 13px; color: #888; margin-top: 4px; }
    .tip { font-size: 13px; color: #555; }
  </style>
</head>
<body>
  <h2>💰 空投金额估算 <a href="https://x.com/0xXIAOc" target="_blank" style="font-size:14px;">by @0xXIAOc</a></h2>

  <label>假设 FDV（单位：元）：
    <input id="fdvInput" placeholder="例如 600000000" value="600000000">
  </label>

  <p class="tip">草总量 = 943.27 亿草（前 25 万地址统计）</p>

  <label>你拥有的草数量：</label>
  <input id="myGrass" value="100000" oninput="formatGrass()" />
  <div id="formattedGrass" class="small-note"></div>

  <label>空投百分比（多个用逗号分隔）：</label>
  <input id="percentInput" placeholder="例如：3,5,10,15,20" />

  <button onclick="updateAirdropTable(this)">计算</button>

  <div id="errorMsg" class="error"></div>

  <table>
    <thead>
      <tr>
        <th>空投百分比</th>
        <th>空投金额（万元）</th>
        <th>每草价格（USD）</th>
        <th>你的草价值（USD）</th>
      </tr>
    </thead>
    <tbody id="airdropTableBody"></tbody>
  </table>

<script>
  function formatNumber(num) {
    return num.toLocaleString("en-US");
  }

  function formatGrass() {
    const val = parseFloat(document.getElementById("myGrass").value) || 0;
    let display = "";
    if (val >= 1e8) display = (val / 1e8).toFixed(2) + " 亿草";
    else if (val >= 1e4) display = (val / 1e4).toFixed(2) + " 万草";
    else display = val + " 草";
    document.getElementById("formattedGrass").innerText = `≈ ${display}`;
  }

  function updateAirdropTable(btn) {
    const errorEl = document.getElementById("errorMsg");
    errorEl.innerText = "";

    const FDV = parseFloat(document.getElementById("fdvInput").value) || 0;
    const totalGrass = 94327000000; // 943.27亿草
    const myGrass = parseFloat(document.getElementById("myGrass").value) || 0;
    const percentStr = document.getElementById("percentInput").value;

    const percents = percentStr.split(",").map(p => parseFloat(p.trim())).filter(p => !isNaN(p) && p > 0 && p <= 100);

    if (percents.length === 0) {
      errorEl.innerText = "⚠️ 空投百分比格式错误，请输入如：3,5,10";
      return;
    }

    // 按钮 loading 效果
    const originalText = btn.innerText;
    btn.innerText = "计算中...";
    btn.disabled = true;

    setTimeout(() => {
      let html = "";

      percents.forEach(pct => {
        const airdropAmount = FDV * (pct / 100);
        const grassPrice = airdropAmount / totalGrass;
        const myValue = myGrass * grassPrice;

        html += `<tr>
          <td>${pct}%</td>
          <td>${(airdropAmount / 10000).toFixed(2)}</td>
          <td>$${grassPrice.toFixed(6)}</td>
          <td>$${myValue.toFixed(2)}</td>
        </tr>`;
      });

      document.getElementById("airdropTableBody").innerHTML = html;
      btn.innerText = originalText;
      btn.disabled = false;
    }, 500);
  }

  formatGrass();
</script>
</body>
</html>
